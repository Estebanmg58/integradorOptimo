{
  "ConnectionStrings": {
    // ================================================================
    // CONEXIÓN A LA BASE DE DATOS DEL ERP (ORIGEN)
    // ================================================================
    // Esta conexión se usa para LEER datos del ERP
    // Requiere permisos de SELECT y EXECUTE en el SP: ERP_SPConsultaDta
    
    "ErpDatabase": "Server=TU_SERVIDOR_ERP;Database=TU_BD_ERP;User Id=TU_USUARIO;Password=TU_PASSWORD;TrustServerCertificate=true;",
    
    // Ejemplos:
    // SQL Server Local:
    // "ErpDatabase": "Server=localhost;Database=CoopDB;User Id=integrador_user;Password=P@ssw0rd123!;TrustServerCertificate=true;",
    
    // SQL Server Remoto:
    // "ErpDatabase": "Server=192.168.1.100,1433;Database=CoopDB;User Id=integrador_user;Password=P@ssw0rd123!;TrustServerCertificate=true;",
    
    // Windows Authentication:
    // "ErpDatabase": "Server=localhost;Database=CoopDB;Integrated Security=true;TrustServerCertificate=true;",
    
    
    // ================================================================
    // CONEXIÓN A LA BASE DE DATOS DE CONFIGURACIÓN (IntegradorDB)
    // ================================================================
    // Esta conexión se usa para LEER la configuración del Worker
    // Requiere permisos de SELECT en la tabla: IntegrationSettings
    
    "DestinationDatabase": "Server=TU_SERVIDOR_CONFIG;Database=IntegradorDB;User Id=TU_USUARIO;Password=TU_PASSWORD;TrustServerCertificate=true;"
    
    // Ejemplos:
    // Mismo servidor que el ERP:
    // "DestinationDatabase": "Server=localhost;Database=IntegradorDB;User Id=integrador_user;Password=P@ssw0rd123!;TrustServerCertificate=true;",
    
    // Servidor diferente:
    // "DestinationDatabase": "Server=192.168.1.200,1433;Database=IntegradorDB;User Id=config_user;Password=ConfigP@ss!;TrustServerCertificate=true;"
  },
  
  "ApiSettings": {
    // ================================================================
    // CONFIGURACIÓN DE LA API DESTINO
    // ================================================================
    
    // URL base de la API (sin "/" al final)
    "BaseUrl": "https://api.fondosuma.com",
    
    // Ejemplos:
    // Producción:
    // "BaseUrl": "https://api.fondosuma.com",
    
    // Desarrollo:
    // "BaseUrl": "https://dev-api.fondosuma.com",
    
    // Local:
    // "BaseUrl": "https://localhost:7001",
    
    
    // API Key para autenticación (X-API-Key header)
    "ApiKey": "LlaveAuthApiKey-!@#"
    
    // IMPORTANTE: 
    // 1. Esta API Key debe coincidir con la configurada en la API destino
    // 2. Solicitar la API Key al equipo de la API de FondoSuma
    // 3. NO compartir esta API Key en repositorios públicos
    // 4. Para producción, usar variables de entorno o Azure Key Vault
  },
  
  "Serilog": {
    "MinimumLevel": {
      // Nivel de logging
      // Opciones: Verbose, Debug, Information, Warning, Error, Fatal
      "Default": "Information",
      "Override": {
        "Microsoft": "Warning",
        "System": "Warning"
      }
    },
    "WriteTo": [
      {
        // Log en consola
        "Name": "Console",
        "Args": {
          "outputTemplate": "{Timestamp:yyyy-MM-dd HH:mm:ss.fff} [{Level:u3}] {Message:lj}{NewLine}{Exception}"
        }
      },
      {
        // Log en archivos (rotación diaria)
        "Name": "File",
        "Args": {
          "path": "logs/log-.txt",
          "rollingInterval": "Day",
          "outputTemplate": "{Timestamp:yyyy-MM-dd HH:mm:ss.fff} [{Level:u3}] {Message:lj}{NewLine}{Exception}",
          "retainedFileCountLimit": 30
        }
      }
    ]
  }
}

/*
???????????????????????????????????????????????????????????????????
                    GUÍA DE CONFIGURACIÓN
???????????????????????????????????????????????????????????????????

?? PASOS PARA CONFIGURAR:

1. CONFIGURAR CONEXIÓN AL ERP:
   ? Reemplaza "TU_SERVIDOR_ERP" con el nombre o IP del servidor
   ? Reemplaza "TU_BD_ERP" con el nombre de la base de datos del ERP
   ? Reemplaza "TU_USUARIO" y "TU_PASSWORD" con las credenciales
   ? Verifica que el usuario tenga permisos de SELECT y EXECUTE

2. CONFIGURAR CONEXIÓN A IntegradorDB:
   ? Reemplaza "TU_SERVIDOR_CONFIG" con el servidor (puede ser el mismo)
   ? Asegúrate de haber ejecutado el script: 01_CreateDatabase.sql
   ? Verifica que el usuario tenga permisos de SELECT

3. CONFIGURAR API:
   ? Reemplaza la BaseUrl con la URL real de la API
   ? Solicita la ApiKey al equipo de FondoSuma
   ? Verifica conectividad con: curl -X POST https://api.fondosuma.com/api/health

4. PROBAR CONEXIONES:
   ? Ejecuta el Worker en modo debug (F5)
   ? Revisa los logs en: logs/log-YYYY-MM-DD.txt
   ? Verifica que conecte a ambas bases de datos

???????????????????????????????????????????????????????????????????
                    EJEMPLO COMPLETO REAL
???????????????????????????????????????????????????????????????????

{
  "ConnectionStrings": {
    "ErpDatabase": "Server=192.168.1.50,1433;Database=CooperativaDB;User Id=integrador_user;Password=IntP@ss2024!;TrustServerCertificate=true;Connection Timeout=120;",
    "DestinationDatabase": "Server=192.168.1.50,1433;Database=IntegradorDB;User Id=integrador_user;Password=IntP@ss2024!;TrustServerCertificate=true;"
  },
  "ApiSettings": {
    "BaseUrl": "https://api.fondosuma.com",
    "ApiKey": "xK9#mP2$vL8@qR5&nT3"
  },
  "Serilog": {
    "MinimumLevel": {
      "Default": "Information"
    }
  }
}

???????????????????????????????????????????????????????????????????
                    TROUBLESHOOTING
???????????????????????????????????????????????????????????????????

? ERROR: "Login failed for user"
? SOLUCIÓN: Verificar usuario y contraseña en SQL Server

? ERROR: "A network-related error occurred"
? SOLUCIÓN: 
   - Verificar que SQL Server acepte conexiones remotas
   - Verificar firewall en puerto 1433
   - Ping al servidor: ping TU_SERVIDOR

? ERROR: "Cannot open database"
? SOLUCIÓN: Verificar que la base de datos existe

? ERROR: "401 Unauthorized" en API
? SOLUCIÓN: Verificar que la ApiKey sea correcta

? ERROR: "SSL connection error"
? SOLUCIÓN: Agregar TrustServerCertificate=true

???????????????????????????????????????????????????????????????????
                    SEGURIDAD
???????????????????????????????????????????????????????????????????

?? RECOMENDACIONES:

1. NO subir appsettings.json con credenciales reales a Git
2. Usar appsettings.Production.json para producción
3. Usar variables de entorno para credenciales sensibles
4. Rotar la ApiKey periódicamente
5. Usar Azure Key Vault en producción

VARIABLES DE ENTORNO (alternativa):
- ConnectionStrings__ErpDatabase
- ConnectionStrings__DestinationDatabase
- ApiSettings__BaseUrl
- ApiSettings__ApiKey

???????????????????????????????????????????????????????????????????
*/
